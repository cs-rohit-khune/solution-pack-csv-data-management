{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Read Reports and update assets",
    "aliasName": null,
    "tag": null,
    "description": "Reads and merges two reports. Resulting data set is used to create\/ update assets in FortiSOAR",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/5c265a46-01de-4ba8-9b5a-b8bae4335b35",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/0dbbd5e3-4d80-40b0-a31e-c4410e8c25f6",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "f1a74e4f-1b71-4c34-800c-b01ba19a0b7e",
                "resources": [
                    "attachments",
                    "alerts"
                ],
                "inputVariables": [
                    {
                        "name": "selectFirstFile",
                        "type": "attachments",
                        "label": "Select First File",
                        "title": "Lookup (One to Many or One to One)",
                        "usable": true,
                        "tooltip": "",
                        "dataType": "lookup",
                        "formType": "lookup",
                        "required": true,
                        "_expanded": true,
                        "mmdUpdate": true,
                        "collection": false,
                        "dataSource": {
                            "model": "attachments"
                        },
                        "searchable": false,
                        "templateUrl": "app\/components\/form\/fields\/typeahead.html",
                        "defaultValue": {
                            "id": 15,
                            "@id": "\/api\/3\/attachments\/b7ba8c3b-9b7e-4991-89bb-b62209ccf539",
                            "file": {
                                "id": "28ce9a37-b23f-4d47-8257-e98f0d3c7564",
                                "@id": "\/api\/3\/files\/28ce9a37-b23f-4d47-8257-e98f0d3c7564",
                                "size": 103426,
                                "uuid": "28ce9a37-b23f-4d47-8257-e98f0d3c7564",
                                "@type": "File",
                                "assignee": "",
                                "filename": "Vulnerability-Report.csv",
                                "metadata": [],
                                "mimeType": "text\/csv",
                                "thumbnail": null,
                                "uploadDate": 1651225337.329327
                            },
                            "name": "Vulnerability Scans Report",
                            "type": null,
                            "uuid": "b7ba8c3b-9b7e-4991-89bb-b62209ccf539",
                            "@type": "Attachment",
                            "display": "Vulnerability Scans Report",
                            "assignee": "",
                            "createDate": 1651225339.729186,
                            "createUser": {
                                "id": 3,
                                "@id": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "type": null,
                                "uuid": "3451141c-bac6-467c-8d72-85e0fab569ce",
                                "@type": "Person",
                                "email": "admin@example.com",
                                "title": "Admin",
                                "avatar": null,
                                "userId": "12d04e80-d7ac-47ad-ba26-3f9985730a98",
                                "csActive": true,
                                "lastname": "Admin",
                                "phoneFax": null,
                                "userType": null,
                                "@settings": "\/api\/3\/user_settings\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "companyId": null,
                                "firstname": "CS",
                                "phoneHome": null,
                                "phoneWork": "+16462759691",
                                "accessType": "Named",
                                "createDate": 1650477241.639942,
                                "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "department": null,
                                "modifyDate": 1650477241.639942,
                                "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "description": null,
                                "phoneMobile": null
                            },
                            "modifyDate": 1651225339.729186,
                            "modifyUser": {
                                "id": 3,
                                "@id": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "type": null,
                                "uuid": "3451141c-bac6-467c-8d72-85e0fab569ce",
                                "@type": "Person",
                                "email": "admin@example.com",
                                "title": "Admin",
                                "avatar": null,
                                "userId": "12d04e80-d7ac-47ad-ba26-3f9985730a98",
                                "csActive": true,
                                "lastname": "Admin",
                                "phoneFax": null,
                                "userType": null,
                                "@settings": "\/api\/3\/user_settings\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "companyId": null,
                                "firstname": "CS",
                                "phoneHome": null,
                                "phoneWork": "+16462759691",
                                "accessType": "Named",
                                "createDate": 1650477241.639942,
                                "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "department": null,
                                "modifyDate": 1650477241.639942,
                                "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "description": null,
                                "phoneMobile": null
                            },
                            "recordTags": [],
                            "description": null
                        },
                        "_previousName": "selectFirst",
                        "displayTemplate": "%7B%7B%20name%20%7D%7D",
                        "lengthConstraint": false,
                        "allowedEncryption": false,
                        "allowedGridColumn": true,
                        "useRecordFieldDefault": false
                    },
                    {
                        "name": "selectSecondFile",
                        "type": "attachments",
                        "label": "Select Second File",
                        "title": "Lookup (One to Many or One to One)",
                        "usable": true,
                        "tooltip": "",
                        "dataType": "lookup",
                        "formType": "lookup",
                        "required": true,
                        "_expanded": true,
                        "mmdUpdate": true,
                        "collection": false,
                        "dataSource": {
                            "model": "attachments"
                        },
                        "searchable": false,
                        "templateUrl": "app\/components\/form\/fields\/typeahead.html",
                        "defaultValue": {
                            "id": 16,
                            "@id": "\/api\/3\/attachments\/1cc2df1c-d731-458e-85cd-7af6a7e12ecf",
                            "file": {
                                "id": "b6ce0578-dcd4-41da-884d-8317c3b31b61",
                                "@id": "\/api\/3\/files\/b6ce0578-dcd4-41da-884d-8317c3b31b61",
                                "size": 30958,
                                "uuid": "b6ce0578-dcd4-41da-884d-8317c3b31b61",
                                "@type": "File",
                                "assignee": "",
                                "filename": "Assets-Details.csv",
                                "metadata": [],
                                "mimeType": "text\/csv",
                                "thumbnail": null,
                                "uploadDate": 1651225401.052685
                            },
                            "name": "Assets Details",
                            "type": null,
                            "uuid": "1cc2df1c-d731-458e-85cd-7af6a7e12ecf",
                            "@type": "Attachment",
                            "display": "Assets Details",
                            "assignee": "",
                            "createDate": 1651225402.168742,
                            "createUser": {
                                "id": 3,
                                "@id": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "type": null,
                                "uuid": "3451141c-bac6-467c-8d72-85e0fab569ce",
                                "@type": "Person",
                                "email": "admin@example.com",
                                "title": "Admin",
                                "avatar": null,
                                "userId": "12d04e80-d7ac-47ad-ba26-3f9985730a98",
                                "csActive": true,
                                "lastname": "Admin",
                                "phoneFax": null,
                                "userType": null,
                                "@settings": "\/api\/3\/user_settings\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "companyId": null,
                                "firstname": "CS",
                                "phoneHome": null,
                                "phoneWork": "+16462759691",
                                "accessType": "Named",
                                "createDate": 1650477241.639942,
                                "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "department": null,
                                "modifyDate": 1650477241.639942,
                                "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "description": null,
                                "phoneMobile": null
                            },
                            "modifyDate": 1651225402.168742,
                            "modifyUser": {
                                "id": 3,
                                "@id": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "type": null,
                                "uuid": "3451141c-bac6-467c-8d72-85e0fab569ce",
                                "@type": "Person",
                                "email": "admin@example.com",
                                "title": "Admin",
                                "avatar": null,
                                "userId": "12d04e80-d7ac-47ad-ba26-3f9985730a98",
                                "csActive": true,
                                "lastname": "Admin",
                                "phoneFax": null,
                                "userType": null,
                                "@settings": "\/api\/3\/user_settings\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "companyId": null,
                                "firstname": "CS",
                                "phoneHome": null,
                                "phoneWork": "+16462759691",
                                "accessType": "Named",
                                "createDate": 1650477241.639942,
                                "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "department": null,
                                "modifyDate": 1650477241.639942,
                                "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                "description": null,
                                "phoneMobile": null
                            },
                            "recordTags": [],
                            "description": null
                        },
                        "_previousName": "selectSecondF",
                        "displayTemplate": "%7B%7B%20name%20%7D%7D",
                        "lengthConstraint": false,
                        "allowedEncryption": false,
                        "allowedGridColumn": true,
                        "useRecordFieldDefault": false
                    },
                    {
                        "name": "columnName",
                        "type": "string",
                        "label": "Column(s) name which is common to both files",
                        "tooltip": "",
                        "dataType": "text",
                        "formType": "text",
                        "required": true,
                        "_expanded": true,
                        "_nameTouched": true,
                        "defaultValue": "IP_Address",
                        "_previousName": "provideColumn(S)WhichIsCommonToBothFiles",
                        "useRecordFieldDefault": false
                    }
                ],
                "step_variables": {
                    "input": {
                        "params": {
                            "columnName": "{{vars.request.data[\"columnName\"]}}",
                            "selectFirstFile": "{{vars.request.data[\"selectFirstFile\"]}}",
                            "selectSecondFile": "{{vars.request.data[\"selectSecondFile\"]}}"
                        },
                        "records": "{{vars.input.records}}"
                    }
                },
                "_promptexpanded": true,
                "displayConditions": {
                    "attachments": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Submit",
                "noRecordExecution": true,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "40",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "0dbbd5e3-4d80-40b0-a31e-c4410e8c25f6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Read Report and Create DataSet",
            "description": null,
            "arguments": {
                "name": "CSV Data Management",
                "params": {
                    "input": "Attachment IRI",
                    "recordBatch": false,
                    "deDupValuesOn": "IP_Address",
                    "file_one_value": "{{vars.input.params.selectFirstFile['@id']}}",
                    "file_two_value": "{{vars.input.params.selectSecondFile['@id']}}",
                    "mergeColumnNames": "{{vars.input.params.columnName}}",
                    "file1_column_names": "",
                    "file2_column_names": "",
                    "numberOfRowsToSkipFirst": "",
                    "numberOfRowsToSkipSecond": ""
                },
                "version": "1.0.0",
                "connector": "csv-data-management",
                "operation": "merge_two_csv_and_extract_data",
                "operationTitle": "Merge and Extract Data from two CSV",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "160",
            "left": "200",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "8e737b0a-4652-4ceb-9b59-1a4c9a885eea"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Or Update Assets Detail",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Read_Report_and_Create_DataSet.data}}",
                    "__bulk": true,
                    "parallel": false,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "ip": "{{vars.item.IP_Address}}",
                    "hostname": "{{vars.item.domain_name}}",
                    "__replace": "true",
                    "description": "Vulnerability Details\n\nCVE ID : {{vars.item['CVE ID']}}\n\nCVSS : {{vars.item.CVSS}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/assets",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "296",
            "left": "374",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "3e574762-4214-4b3e-890d-5a8e6f239f07"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Read Report and Create DataSet",
            "targetStep": "\/api\/3\/workflow_steps\/8e737b0a-4652-4ceb-9b59-1a4c9a885eea",
            "sourceStep": "\/api\/3\/workflow_steps\/0dbbd5e3-4d80-40b0-a31e-c4410e8c25f6",
            "label": null,
            "isExecuted": false,
            "uuid": "8a91ff68-f395-40c6-9d91-7f0044f816e4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Read Report and Create DataSet -> Create Or Update Assets Detail",
            "targetStep": "\/api\/3\/workflow_steps\/3e574762-4214-4b3e-890d-5a8e6f239f07",
            "sourceStep": "\/api\/3\/workflow_steps\/8e737b0a-4652-4ceb-9b59-1a4c9a885eea",
            "label": null,
            "isExecuted": false,
            "uuid": "856a0ee1-4b00-4957-a67b-f865e839b4c6"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "ab7b60c7-b8fe-4442-83cb-145bdd9169bb",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": []
}